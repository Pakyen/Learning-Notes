# 线程安全问题

## 线程安全问题概述

假设卖100张票，一个窗口卖100张票，没有问题
* **单线程程序是不会出现线程安全问题的**
![](%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98/%E6%88%AA%E5%B1%8F2021-03-02%2015.03.37.png)

* **多线程程序，如果没有访问共享数据，不会产生问题**

* **多线程如果访问了共享数据，就会产生线程安全问题**

- - - -
## 线程完全问题产生的原理
<a href='RunnableImpl(1).java'>RunnableImpl(1).java</a>
<a href='Demo01Ticket.java'>Demo01Ticket.java</a>
在main方法中，使用Runnable接口的实现类创建对象，创建三个线程t0 t1 t2
这三个线程会一起抢夺cpu的资源；假设一开始t0抢到了cpu的执行权，那么它就会执行run方法，在执行到if语句后，t0就会失去对cpu的执行权（因为使用了sleep）
<a href='12_%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98%E4%BA%A7%E7%94%9F%E7%9A%84%E5%8E%9F%E7%90%86.flv'>12_线程安全问题产生的原理.flv</a>
![](%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98/%E6%88%AA%E5%B1%8F2021-03-02%2015.14.01.png)


* 注意：线程安全问题是不能产生的，所以我们可以让一个线程在访问共享数据的时候，无论是否失去了cpu的执行权，让其他的线程只能等待，等待当前线程卖完票，其他线程再进行买票
* 保证使用一个线程在卖票即可


















