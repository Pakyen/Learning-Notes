# 多线程

## 并发与并行
* **并发**：指两个或多个事件在**同一个时间段**内发生（交替执行）
* **并行**：指两个或多个事件在**同一时刻发生（同时发生）**
![](%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E6%88%AA%E5%B1%8F2021-03-01%2012.00.07.png)
![](%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E6%88%AA%E5%B1%8F2021-03-01%2012.31.20.png)


## 进程与线程
*  **进程**：
	* **进入到内存中的程序就叫做进程**，每个进程都有一个独立的内存空间，一个应用程序可以同时运行多个进程；
	* 进程也是程序的一次执行过程，是系统运行程序的基本单位；
	* 系统运行一个程序即是一个进程从创建、运行到消亡的过程

* **线程**：
	* **线程是进程的一个执行单元**，负责当前进程中程序的执行，线程就是通向cpu的一条路径
	* 一个进程中至少有一个线程，一个进程中也可以有多个线程，这个应用程序也可以称为多线程程序
	
* 总而言之，一个程序运行后至少有一个进程，一个进程中可以包含多个线程
![](%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E6%88%AA%E5%B1%8F2021-03-01%2012.26.57.png)


## 线程调度
* **分时调度** 
	所有线程轮流使用 CPU 的使用权，平均分配每个线程占用 CPU 的时间
 
* **抢占式调度** 
	优先让优先级高的线程使用 CPU，如果线程的优先级相同，那么会随机选择一个(线程随机性)，Java使用的为抢占式调度。


### 抢占式调度详解
大部分操作系统都支持多进程并发运行，现在的操作系统几乎都支持同时运行多个程序。比如：现在我们上课一边使用编辑器，一边使用录屏软件，同时还开着画图板，dos窗口等软件。此时，这些程序是在同时运行，”感觉这些软件好像在同一时刻运行着“。
实际上，CPU(中央处理器)使用抢占式调度模式在多个线程间进行着高速的切换。对于CPU的一个核而言，某个时刻，只能执行一个线程，而 CPU的在多个线程间切换速度相对我们的感觉要快，看上去就是在同一时刻运行。
其实，多线程程序并不能提高程序的运行速度，但能够提高程序运行效率，让CPU的使用率更高。

## 主线程
* 主线程就是执行主方法(main)的线程

* 单线程程序：java程序中只有一个线程，执行从main方法开始，从上到下依次执行
![](%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E6%88%AA%E5%B1%8F2021-03-01%2012.39.26.png)


## 创建线程类
* Java使用`java.lang.Thread`类代表**线程**，所有的线程对象都必须是Thread类或其子类的实例
* 每个线程的作用是完成一定的任务，实际上就是执行一段程序流即一段顺序执行的代码
* Java使用线程执行体来代表这段程序流

### 创建多线程程序的方式（2种）

> 创建一个线程对象然后使用start()方法即可启动线程  

#### 创建Thread类的子类（创建多线程程序的第一种方式）

> `java.lang.Thread`类 是描述线程的类，我们想要实现多线程程序，就必须继承Thread类（ Java中通过继承Thread类来**创建**并**启动多线程**）  

实现步骤：
1. ::创建一个Thread类的子类::
2. 在Thread类的子类中::重写Thread类中的run方法::，设置线程任务（开启线程要做什么？）
3. ::创建Thread类的子类对象::
4. ::调用Thread类中的方法start方法::，开启新的线程，执行run方法
	* void start() 使该线程开始执行；Java 虚拟机调用该线程的 run 方法
	* 结果是两个线程并发地运行；当前线程（main线程）和另一个线程（创建的新线程,执行其 run 方法）
	* 多次启动一个线程是非法的。特别是当线程已经结束执行后，不能再重新启动。

java程序属于抢占式调度,那个线程的优先级高,那个线程优先执行;同一个优先级,随机选择一个执行
![](%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E6%88%AA%E5%B1%8F2021-03-01%2012.51.50.png)
![](%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E6%88%AA%E5%B1%8F2021-03-01%2012.52.39.png)
![](%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E6%88%AA%E5%B1%8F2021-03-01%2012.52.20.png)
