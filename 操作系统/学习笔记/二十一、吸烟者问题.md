# 二十一、吸烟者问题

## 问题描述

假设一个系统有**三个抽烟者**和进程。每个抽烟者不停地卷烟并抽掉它，但是要卷起并抽掉一支烟，抽烟者需要有三种材料:烟草、纸和胶水。三个抽烟者中，第一个拥有烟草、第二个拥有纸、第三个拥有胶水。 供应者进程无限地提供三种材料，供应者每次将两种材料放桌子上，拥有剩下那种材料的抽烟者卷一根烟并抽掉它，并给供应者进程一个信号告诉完成了，供应者就会放另外两种材料在桌上。轮流让三个抽烟者抽烟

![](%E4%BA%8C%E5%8D%81%E4%B8%80%E3%80%81%E5%90%B8%E7%83%9F%E8%80%85%E9%97%AE%E9%A2%98/%E6%88%AA%E5%B1%8F2021-04-06%2013.23.07.png)

1. 关系分析
> 材料虽然每次放两种，但不应该单独地作为两种材料，应该看成一种组合  
* 互斥关系：桌子抽象为容量为1的缓冲区，要互斥访问
	* 组合一：纸、胶水
	* 组合二：烟草、胶水
	* 组合三：纸、烟草

* 同步关系：
	* 桌子上有组合一 -> 第一个抽烟者取走东西
	* 桌子上有组合二 -> 第二个抽烟者取走东西
	* 桌子上有组合三 -> 第三个抽烟者取走东西
	* 发出完成信号 -> 供应者将下一个组合放到桌上

![](%E4%BA%8C%E5%8D%81%E4%B8%80%E3%80%81%E5%90%B8%E7%83%9F%E8%80%85%E9%97%AE%E9%A2%98/%E6%88%AA%E5%B1%8F2021-04-06%2013.43.29.png)


## 总结
吸烟者问题主要解决：**可以生产多个产品的单生产者**问题


