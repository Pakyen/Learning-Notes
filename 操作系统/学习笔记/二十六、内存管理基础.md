# 二十六、内存管理基础

## 1. 内存的基础知识
![](%E4%BA%8C%E5%8D%81%E5%85%AD%E3%80%81%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E5%9F%BA%E7%A1%80/0587CE5E-774D-41EE-B74F-803664793C5C.png)

### 1.1 什么是内存（存储单元&内存地址）
![](%E4%BA%8C%E5%8D%81%E5%85%AD%E3%80%81%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E5%9F%BA%E7%A1%80/%E6%88%AA%E5%B1%8F2021-06-24%2016.17.27.png)
* ⚠️腾讯面试遇到过这个问题。2^30个字节是1GB，也就是8 * 2^30位
![](%E4%BA%8C%E5%8D%81%E5%85%AD%E3%80%81%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E5%9F%BA%E7%A1%80/181C65B9-64C6-4D7C-9BCD-D3ED85BDB9DB.png)

### 1.2 进程运行的基本原理
1. 指令的工作原理
![](%E4%BA%8C%E5%8D%81%E5%85%AD%E3%80%81%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E5%9F%BA%E7%A1%80/%E6%88%AA%E5%B1%8F2021-06-24%2016.27.28.png)
2. 逻辑地址 vs. 物理地址
	* 逻辑地址（相对地址）
	* 物理地址（绝对地址）
![](%E4%BA%8C%E5%8D%81%E5%85%AD%E3%80%81%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E5%9F%BA%E7%A1%80/%E6%88%AA%E5%B1%8F2021-06-24%2016.28.47.png)

3. 从写程序到程序运行：编辑 - 编译 - 链接 - 装入
![](%E4%BA%8C%E5%8D%81%E5%85%AD%E3%80%81%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E5%9F%BA%E7%A1%80/%E6%88%AA%E5%B1%8F2021-06-24%2016.29.51.png)

4. 三种链接方式
	* 静态链接
	* 装入时动态链接
	* 运行时动态链接

5. 三种装入方式
	* 绝对装入
	* 静态重定位
	* 动态重定位哦

![](%E4%BA%8C%E5%8D%81%E5%85%AD%E3%80%81%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E5%9F%BA%E7%A1%80/0587CE5E-774D-41EE-B74F-803664793C5C%202.png)

## 2. 内存管理的概念
	1. 让操作系统负责**内存空间的分配与回收**
	2. 操作系统需要提供某种技术从逻辑上**对内存空间进行扩充**（虚拟性）
	3. 操作系统需要提供**地址转换功能**，负责程序的**逻辑地址与物理地址的转换**
		转换的三种方式就是三种装入方式（绝对装入，可重定位装入，动态运行时装入）
![](%E4%BA%8C%E5%8D%81%E5%85%AD%E3%80%81%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E5%9F%BA%E7%A1%80/%E6%88%AA%E5%B1%8F2021-06-24%2016.40.45.png)
	4. 操作系统需要提供**内存保护**功能，保证各进程在各自存储空间内运行，互不干扰
![](%E4%BA%8C%E5%8D%81%E5%85%AD%E3%80%81%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E5%9F%BA%E7%A1%80/%E6%88%AA%E5%B1%8F2021-06-24%2016.48.14.png)

### 2.1 内存空间的分配与回收
	* 连续分配管理方式
		* 单一连续分配
		* 固定分区分配
		* 动态分区分配
	* 非连续分配管理方式
### 2.2 内存空间的扩充
	1. 覆盖技术
	2. 交换技术
	3. 虚拟存储技术

### 2.3 地址转换
	* 三种装入方式
		* 绝对装入：编译器负责地址转换（单道程序阶段，无操作系统）
		* 可重定位装入：装入程序时负责地址转换（早期多道批处理阶段）
		* 动态运行时装入：运行时才进行地址转换（现代操作系统）

### 2.4 存储保护（内存保护）
	* 设定上下限寄存器
![](%E4%BA%8C%E5%8D%81%E5%85%AD%E3%80%81%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E5%9F%BA%E7%A1%80/4B982B22-C9E1-43A6-8E7C-1FA61E9ED4E0.png)

	* 利用重定位寄存器、界地址寄存器进行判断
		* **重定位寄存器**存放进程的**起始物理地址**
		* **界地址寄存器**存放进程的**最大逻辑地址**
![](%E4%BA%8C%E5%8D%81%E5%85%AD%E3%80%81%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E5%9F%BA%E7%A1%80/753150F4-638C-41BB-908D-3385870845F9.png)



