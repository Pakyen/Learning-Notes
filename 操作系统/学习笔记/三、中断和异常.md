# 三、中断和异常

 

## 1. 中断
![](%E4%B8%89%E3%80%81%E4%B8%AD%E6%96%AD%E5%92%8C%E5%BC%82%E5%B8%B8/%E6%88%AA%E5%B1%8F2021-03-24%2012.25.16.png)


## 1.1 中断与CPU状态的切换
问：用户态、核心态之间的切换时怎么实现的？
	“用户态 -> 核心态” 是通过**中断**实现的，并且中断是用户态切换到核心态的**唯一**途径

* 用户态 -> 核心态
	* **中断是用户态到核心态切换的唯一途径。**
* 核心态 -> 用户态
	* **核心态到用户态的切换只需要通过CPU执行一个特权指令，将程序状态字(PSW)的标志位设置为用户态。**

## 1.2 中断的分类
![](%E4%B8%89%E3%80%81%E4%B8%AD%E6%96%AD%E5%92%8C%E5%BC%82%E5%B8%B8/%E6%88%AA%E5%B1%8F2021-03-24%2012.29.50.png)

 内中断的外中断的本质区别是**信号来源不同**
 ![](%E4%B8%89%E3%80%81%E4%B8%AD%E6%96%AD%E5%92%8C%E5%BC%82%E5%B8%B8/%E6%88%AA%E5%B1%8F2021-03-24%2012.30.59.png)


## 1.3 外中断的处理过程
1. 执行完每条指令之后，CPU会**检查**当前是否有**外部中断信号**。

2. 如果检测到**外部中断信号** (比如打印机工作完成了)，则需要**保护**被中断进程的CPU环境 (如程序状态字PSW, 程序计数器PC,各种通用寄存器的值)。

3. 根据中断信号类型转入相应的**中断处理程序**。

4. **恢复**原进程的CPU环境并退出中断处理程序，返回原进程继续往下执行


## 总结
![](%E4%B8%89%E3%80%81%E4%B8%AD%E6%96%AD%E5%92%8C%E5%BC%82%E5%B8%B8/%E6%88%AA%E5%B1%8F2021-03-24%2012.35.07.png)





 