# 十三、调度算法（FCFS、SJF、HRRN）

![](%E5%8D%81%E4%B8%89%E3%80%81%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95%EF%BC%88FCFS%E3%80%81SJF%E3%80%81HRRN%EF%BC%89/%E6%88%AA%E5%B1%8F2021-03-27%2013.18.42.png)
![](%E5%8D%81%E4%B8%89%E3%80%81%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95%EF%BC%88FCFS%E3%80%81SJF%E3%80%81HRRN%EF%BC%89/%E6%88%AA%E5%B1%8F2021-03-29%2012.53.55.png)

## 1. 先来先服务（FCFS,First Come First Serve ）
	* 算法思想
		**按照 作业/进程 到达的先后顺序进行服务**

		* 用于**作业**调度时，考虑的是哪个作业先到达**后备**队列
		* 用于**进程**调度时，考虑的是哪个进程先到达**就绪**队列

	* 是否可抢占？
		* 先来先服务是**非抢占式**的算法

	* 优点
		* 公平、算法实现简单

	* 缺点
		* 排在长作业(进程)后面的短作业需要等待很长时间，带权周转时间很大，对短作业来说用户体验不好。即，FCFS算法对长作业有利，对短作业不利

> 			带权周转时间 = 作业周转时间 / 作业实际运行的时间  
> 			作业周转时间 = 作业完成时间 - 作业提交时间  

	* 是否会导致饥饿
		* 不会，不管是哪个作业，只要一直等着，是不会得不到服务的

## 2. 短作业优先（SJF，Shortest Job First)
	* 算法思想
		* **最短的 作业/进程 优先得到服务**
		* （最短是指要求服务时间最短）
		* 追求最少的平均等待时间，最少的平均周转时间、最少的平均带权周转时间

	* 可以用于作业调度，也可以用于进程调度，用于进程调度时，称为「短进程优先」（SPF，Shortest Process First）算法

	* 是否可抢占？
		* 短作业优先和短进程优先 **默认**是 **非抢占式的**
		* 但是**也有**抢占式的版本 - *最短剩余时间优先算法*（SRTN，Shortest Remaining Time Next）

	* 优点
		* “最短的” 平均等待时间、平均周转时间
			* 双引号是因为，在所有进程同时可运行时，或者所有进程几乎同时到达了时，短作业优先的平均等待时间、平均周转时间才最短；否则抢占式的短作业优先：最短剩余时间优先的 平均等待/周转/带权周转时间都要更短

	* 缺点
		* 	不公平。**对短作业有利，对长作业不利**，可能产生**饥饿现象**
		* 	另外，作业/进程的运行时间是由用户提供的，并不一定真实，不一定能做到真正的短作业优先

	* 是否会导致饥饿
		* 会，如果一直有短作业/进程到来，可能使长作业/进程长时间得不到服务，产生**饥饿**现象。如果一直得不到服务，则称为**饿死**



### 短作业优先 和 最短剩余时间优先 算法的区别
	* 非抢占式短作业优先
![](%E5%8D%81%E4%B8%89%E3%80%81%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95%EF%BC%88FCFS%E3%80%81SJF%E3%80%81HRRN%EF%BC%89/%E6%88%AA%E5%B1%8F2021-03-29%2011.57.01.png)

	* 最短剩余时间优先（抢占式）
		* 每当有进程加入 **就绪队列改变时 就需要调度**
		* 如果新到达的进程的**剩余时间**比当前正在运行的进程的剩余时间**更短**，则由新进程抢占CPU，当前运行进程重新回到就绪队列
		* 另外，当一个**进程完成时也需要调度**
![](%E5%8D%81%E4%B8%89%E3%80%81%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95%EF%BC%88FCFS%E3%80%81SJF%E3%80%81HRRN%EF%BC%89/%E6%88%AA%E5%B1%8F2021-03-29%2012.28.05.png)
![](%E5%8D%81%E4%B8%89%E3%80%81%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95%EF%BC%88FCFS%E3%80%81SJF%E3%80%81HRRN%EF%BC%89/%E6%88%AA%E5%B1%8F2021-03-29%2012.28.43.png)


### 对FCFS和SJF两种算法的思考
![](%E5%8D%81%E4%B8%89%E3%80%81%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95%EF%BC%88FCFS%E3%80%81SJF%E3%80%81HRRN%EF%BC%89/375CC6FB-3F23-4200-82B9-1FA24BDB2819.png)



## 3. 高响应比优先（HRRN，Highest Response Ratio Next）
	* 算法思想
		* 综合考虑作业/进程的等待时间和要求服务的时间
		* 在每次调度时先计算各个作业/进程的响应比，选择相应比最高的作业/进程为其服务
		* 响应比 = （等待时间+要求服务时间）/ 要求服务时间

	* 即可以用于作业调度，也可用于进程调度

	* 是否可抢占？
		* 是**非抢占式**的算法。因此只有当运行的作业/进程主动放弃cpu时（正常/异常完成，或主动阻塞），才需要调度，才需要计算响应比

	* 优点
		* **综合考虑了等待时间和运行时间**(要求服务时间）
		* 等待时间相同时，要求服务时间短的优先（SJF的优点）
		* 要求服务时间相同时，等待时间长的优先（FCFS的优点）
		* 对于长作业来说，随着等待时间越来越久，响应比也会越来越大，从而避免了长作业饥饿的问题

	* 是否会导致饥饿
		* 不会

![](%E5%8D%81%E4%B8%89%E3%80%81%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95%EF%BC%88FCFS%E3%80%81SJF%E3%80%81HRRN%EF%BC%89/%E6%88%AA%E5%B1%8F2021-03-29%2012.49.46.png)



## 小结
![](%E5%8D%81%E4%B8%89%E3%80%81%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95%EF%BC%88FCFS%E3%80%81SJF%E3%80%81HRRN%EF%BC%89/%E6%88%AA%E5%B1%8F2021-03-29%2012.53.55%202.png)


