# 十一、进程调度的时机、切换与过程调度方式

![](%E5%8D%81%E4%B8%80%E3%80%81%E8%BF%9B%E7%A8%8B%E8%B0%83%E5%BA%A6%E7%9A%84%E6%97%B6%E6%9C%BA%E3%80%81%E5%88%87%E6%8D%A2%E4%B8%8E%E8%BF%87%E7%A8%8B%E8%B0%83%E5%BA%A6%E6%96%B9%E5%BC%8F/%E6%88%AA%E5%B1%8F2021-03-26%2021.39.44.png)

## 进程调度的时机
> 进程调度(低级调度)，就是按照某种算法从就绪队列中选择一个进程为其分配CPU  

* 什么时候需要使用到进程调度与切换？
	
	* 当前运行的进程**主动**放弃处理机
		* 	进程正常终止
		* 运行过程中发生异常而终止。(如 内中断)
		* 进程主动请求阻塞。(如 请求使用打印机、等待I/O)

	* 当前运行的进程**被动**放弃处理机
		* 分配给该进程的时间片用完
		* 有更紧急的事情要处理。(如 外中断：I/O中断)
		* 有更高优先级的进程进入就绪队列

> 注意：有的系统只允许进程主动放弃处理机，而在有的系统，进程可以既主动放弃处理机，又可以被剥夺处理机(当有更紧急的任务需要处理时)  


当然，有时候也**不能**进行进程调度与切换
* **不能**进行进程调度与切换的情况
	* **在处理中断的过程中**。中断处理过程复杂，与硬件密切相关，很难做到在中断处理的过程中进行进程调度与切换。
	* 在**原子操作过程中**(原语)。原子操作不可中断，要一气呵成。
	* 进程在**操作系统内核程序临界区**中时（不过进程在普通临界区中是可以进行调度、切换的）

> 临界资源：一段时间内只允许一个进程使用的资源。即 各个进程只能互斥的访问临界资源。  
> 临界区：程序中访问临界资源的那段代码  
![](%E5%8D%81%E4%B8%80%E3%80%81%E8%BF%9B%E7%A8%8B%E8%B0%83%E5%BA%A6%E7%9A%84%E6%97%B6%E6%9C%BA%E3%80%81%E5%88%87%E6%8D%A2%E4%B8%8E%E8%BF%87%E7%A8%8B%E8%B0%83%E5%BA%A6%E6%96%B9%E5%BC%8F/%E6%88%AA%E5%B1%8F2021-03-26%2021.55.39.png)
![](%E5%8D%81%E4%B8%80%E3%80%81%E8%BF%9B%E7%A8%8B%E8%B0%83%E5%BA%A6%E7%9A%84%E6%97%B6%E6%9C%BA%E3%80%81%E5%88%87%E6%8D%A2%E4%B8%8E%E8%BF%87%E7%A8%8B%E8%B0%83%E5%BA%A6%E6%96%B9%E5%BC%8F/%E6%88%AA%E5%B1%8F2021-03-26%2021.56.42.png)
![](%E5%8D%81%E4%B8%80%E3%80%81%E8%BF%9B%E7%A8%8B%E8%B0%83%E5%BA%A6%E7%9A%84%E6%97%B6%E6%9C%BA%E3%80%81%E5%88%87%E6%8D%A2%E4%B8%8E%E8%BF%87%E7%A8%8B%E8%B0%83%E5%BA%A6%E6%96%B9%E5%BC%8F/23F33ED0-396E-4070-9195-E7A3CAD922D8.png)

![](%E5%8D%81%E4%B8%80%E3%80%81%E8%BF%9B%E7%A8%8B%E8%B0%83%E5%BA%A6%E7%9A%84%E6%97%B6%E6%9C%BA%E3%80%81%E5%88%87%E6%8D%A2%E4%B8%8E%E8%BF%87%E7%A8%8B%E8%B0%83%E5%BA%A6%E6%96%B9%E5%BC%8F/%E6%88%AA%E5%B1%8F2021-03-26%2022.01.13.png)

## 进程调度的方式
进程调度的方式分为两种，分别是**非抢占式调度**方式和**抢占式调度**方式

![](%E5%8D%81%E4%B8%80%E3%80%81%E8%BF%9B%E7%A8%8B%E8%B0%83%E5%BA%A6%E7%9A%84%E6%97%B6%E6%9C%BA%E3%80%81%E5%88%87%E6%8D%A2%E4%B8%8E%E8%BF%87%E7%A8%8B%E8%B0%83%E5%BA%A6%E6%96%B9%E5%BC%8F/%E6%88%AA%E5%B1%8F2021-03-26%2022.04.14.png)


## 进程的切换与过程

* **狭义的进程调度**：
	狭义的进程调度只是**指从就绪队列中选择一个进程，为其分配CPU资源**（**不包括进程切换**）（这个进程可以是刚刚被停止执行的进程，也可能是另一个进程，如果是另一个进程，那就需要进程交换）

* **进程切换**：
	进程切换是指一个进程让出CPU，由另一个进程占用CPU的过程
	
* **广义的进程调度**：
	广义的进程调度包括了选择进程和切换进程两个步骤

> 进程切换的过程主要完成了：  
> 	1. 对原来运行进程的各种数据的保存  
> 	2. 对新的进程的各种数据的恢复  
> 	（如：程序计数器、各种数据寄存器等信息，一般保存在进程控制块PCB中）  

**注意：进程切换是有代价的，如果过于频繁的进行进程调度、切换，必然会导致整个系统的工作效率降低，使系统大部分时间都花在进程切换上，而使真正用于运行进程的时间减少**


## 小结
![](%E5%8D%81%E4%B8%80%E3%80%81%E8%BF%9B%E7%A8%8B%E8%B0%83%E5%BA%A6%E7%9A%84%E6%97%B6%E6%9C%BA%E3%80%81%E5%88%87%E6%8D%A2%E4%B8%8E%E8%BF%87%E7%A8%8B%E8%B0%83%E5%BA%A6%E6%96%B9%E5%BC%8F/%E6%88%AA%E5%B1%8F2021-03-26%2022.14.48.png)


