# 十五、进程的同步、互斥
![](%E5%8D%81%E4%BA%94%E3%80%81%E8%BF%9B%E7%A8%8B%E7%9A%84%E5%90%8C%E6%AD%A5%E3%80%81%E4%BA%92%E6%96%A5/91200E30-6D52-42ED-9C1F-0C63CA4AA8E6.png)


> 首先，recall一下进程异步：  
> 	进程具有**异步性**的特征。异步性是指，**各并发执行的进程以各自独立的、不可预知的速度向前推进**  

## 1. 进程同步
> 由于并发的执行有异步性，所以不同的进程指令的推进顺序是不可预知的  
> 但是如果我们在并发执行两个进程的时候，需要某个进程的指令在另一个进程的指令之前运行，所以需要这种时候就需要解决异步性的问题，就需要进程同步  

![](%E5%8D%81%E4%BA%94%E3%80%81%E8%BF%9B%E7%A8%8B%E7%9A%84%E5%90%8C%E6%AD%A5%E3%80%81%E4%BA%92%E6%96%A5/%E6%88%AA%E5%B1%8F2021-04-03%2010.31.34.png)
> 再比如，进程的管道通信中，写进程要先往管道里写数据，读进程才能读数据  
> 但是读进程和写进程并发地运行，由于并发必然导致异步性，因此“写数据”和“读数据”两个操作执行的先后顺序是不确定的。而实际应用中，又必须按照“写数据 -> 读数据”的顺序来执行的  
> 如何解决这种异步问题，就是进程同步要解决的内容  

**同步**亦称**直接制约关系**，它是指为完成某种任务而建立的两个或多个进程，这些进程因为需要在某些位置上**协调**它们的**工作次序**而产生的制约关系。进程间的直接制约关系就是源于它们之间的相互合作。


## 2. 进程互斥
> 进程的“并发”需要“共享”的支持。各个并发执行的进程不可避免的需要共享一些系统资源(比如内存，又比如打印机、摄像头这样的I/O设备)  
>   ![](%E5%8D%81%E4%BA%94%E3%80%81%E8%BF%9B%E7%A8%8B%E7%9A%84%E5%90%8C%E6%AD%A5%E3%80%81%E4%BA%92%E6%96%A5/%E6%88%AA%E5%B1%8F2021-04-03%2010.37.26.png)  

我们把**一个时间段内只允许一个进程使用**的资源称为**临界资源** ，许多物理设备( 比如摄像头、打印机)都属于临界资源。此外还有许多变量、数据、内存缓冲区等都属于临界资源

对临界资源的访问，必须**互斥**地进行。互斥，亦称**间接制约关系**。**进程互斥**指当一个进程访问某临界资源时，另一个想要访问该临界资源的进程必须等待。当前访问临界资源的进程访问结束，释放该资源之后，另一个进程才能去访问临界资源

### ps：个人小结
	* 进程同步：直接制约关系，解决进程并发执行时的执行次序问题
	* 进程互斥：间接制约关系，保证多个进程对临界资源的访问维持互斥关系


对临界资源的互斥访问，可以在逻辑上分为如下四个部分:
	* 进入区
	* 临界区
	* 退出区
	* 剩余区
![](%E5%8D%81%E4%BA%94%E3%80%81%E8%BF%9B%E7%A8%8B%E7%9A%84%E5%90%8C%E6%AD%A5%E3%80%81%E4%BA%92%E6%96%A5/%E6%88%AA%E5%B1%8F2021-04-03%2010.50.26.png)

为了实现对临界资源的互斥访问，同时保证系统整体性能，需要遵循以下原则：
	1. **空闲让进**：临界区空闲时,可以允许一个请求进入临界区的进程立即进入临界区
	2. **忙则等待**：当已有进程进入临界区时，其他试图进入临界区的进程必须等待
	3. **有限等待**：对请求访问的进程，应保证能在有限时间内进入临界区(保证不会饥饿)（防止有进程一直占着临界资源）
	4. **让权等待**：当进程不能进入临界区时，应立即释放处理机，防止进程忙等待（忙等待就是一个进程没法继续推进了，但还一直占用着处理机cpu）
	

## 3. 小结
![](%E5%8D%81%E4%BA%94%E3%80%81%E8%BF%9B%E7%A8%8B%E7%9A%84%E5%90%8C%E6%AD%A5%E3%80%81%E4%BA%92%E6%96%A5/91200E30-6D52-42ED-9C1F-0C63CA4AA8E6%202.png)






